--- src/main/java/org/apache/tinkerpop/gremlin/hadoop/structure/io/ObjectWritable.java	2019-06-27 15:41:04.337674642 +0800
+++ patch.txt	2019-06-27 17:42:03.187081212 +0800
@@ -36,6 +36,7 @@
  */
 public final class ObjectWritable<T> implements WritableComparable<ObjectWritable>, Serializable {
 
+    private static final String NULL = "null";
     private static final ObjectWritable<MapReduce.NullObject> NULL_OBJECT_WRITABLE = new ObjectWritable<>(MapReduce.NullObject.instance());
 
     T t;
@@ -57,7 +58,7 @@
 
     @Override
     public String toString() {
-        return this.t.toString();
+        return null == this.t ? NULL : this.t.toString();
     }
 
     @Override
@@ -97,7 +98,9 @@
 
     @Override
     public int compareTo(final ObjectWritable objectWritable) {
-        if (this.t instanceof Comparable)
+        if (null == this.t)
+            return objectWritable.isEmpty() ? 0 : -1;
+        else if (this.t instanceof Comparable && !objectWritable.isEmpty())
             return ((Comparable) this.t).compareTo(objectWritable.get());
         else if (this.t.equals(objectWritable.get()))
             return 0;
@@ -125,7 +128,7 @@
 
     @Override
     public int hashCode() {
-        return this.isEmpty() ? 0 : this.t.hashCode();
+        return null == this.t ? 0 : this.t.hashCode();
     }
 
     public static ObjectWritable<MapReduce.NullObject> getNullObjectWritable() {
